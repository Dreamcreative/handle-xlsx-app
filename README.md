# 将多个 xlsx 的数据通过一定的对应关系，将数据最终汇总到一个表中，生成 xlsx 文件

[handle-xlsx](https://github.com/Dreamcreative/handle-xlsx/blob/master/README.md)

## 取数逻辑

1. 经分表
   根据 e55 拿到 当日优惠后消费金额 ， 且 产品名称 为 ‘全国语音’ 。取 当日优惠后消费金额 的和(一天一条数据) ，填入汇总表的 出账收入
   当日优惠后消费金额=》出账收入

2. 天合表 （最大值，平均值 人为处理好）：根据 目标客户名称 在 映射表中 取到 e55 的值 ，
   天合表的 分配号码数=》码号数量
   天合表的 平台配置并发数=》账户并发
   天合表的 峰值=》平均峰值并发

3. 投诉分析表
   备注 对应 投诉编号
   投诉总量=》 投诉总量
   违规催收=》催收投诉总量

## input 文件夹下，文件提前处理方式

- 汇总表：提前准备好，需要填写字段的空表

* 经分表：需要处理数据的表
* 天合表：已经提前处理好的 分配号码数(最大值) 平台配置并发数(最大值) 峰值(平均值)，并且表头值必须是 分配号码数、平台配置并发数、峰值
* 投诉分析表：1. 将其他无关数据删除，2. 第一行表头删除
* 映射表：准备好 e55 映射关系数据

1. 汇总表

   | 地市 | 集团名称 | `e55计费号` | 投诉编号 | 出账收入 | 码号数量 | 账户并发 | 平均峰值并发 | 投诉总量 | 催收投诉总量 | 非催收投诉总量 | `ARPU值 ` | 收入/并发 | 收入/非催收投诉 | `是否AI` |
   | ---- | -------- | ----------- | -------- | -------- | -------- | -------- | ------------ | -------- | ------------ | -------------- | --------- | --------- | --------------- | -------- |
   | 地市 | 集团名称 | e55 计费号  | 投诉编号 | -        | -        | -        | -            | -        | -            | -              | -         | -         | -               | -        |

2. 经分表

| 日期     | 地市 | 集团名称            | `e55计费号` | 产品名称       | 当日优惠后消费金额 |
| -------- | ---- | ------------------- | ----------- | -------------- | ------------------ |
| 20210926 | 杭州 | 重庆 xxxxxxxxxxxxxx | xxxxxxx     | 全国语音（6s） | 0                  |

3. 天合表

> 已经提前处理好的 分配号码数(最大值) 平台配置并发数(最大值) 峰值(平均值)

| 目标客户名称 | 分配号码数 | 平台配置并发数 | 峰值 |
| ------------ | ---------- | -------------- | ---- |
| DID 测试 1   | 0          | 0              | 0    |

4. 投诉分析表

| 集团名称  | 备注 | 投诉总量 | 违规催收 |
| --------- | ---- | -------- | -------- |
| 北京 xxxx | xxx  | 0        | 0        |

5. 映射表

| 地市 | 集团名称   | `e55计费号` | 投诉编号 | 天合表名称 | 投诉分析表名称 |
| ---- | ---------- | ----------- | -------- | ---------- | -------------- |
| zxx  | DID 测试 1 | xxxxxxxx    | xxxxxx   | xxxx       | xxxxx          |
